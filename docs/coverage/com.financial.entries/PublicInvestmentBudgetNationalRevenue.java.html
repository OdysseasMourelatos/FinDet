<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PublicInvestmentBudgetNationalRevenue.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">FinDet</a> &gt; <a href="index.source.html" class="el_package">com.financial.entries</a> &gt; <span class="el_source">PublicInvestmentBudgetNationalRevenue.java</span></div><h1>PublicInvestmentBudgetNationalRevenue.java</h1><pre class="source lang-java linenums">package com.financial.entries;

import com.financial.services.*;
import com.financial.services.revenues.*;
import java.util.ArrayList;

/**
 * Represents a revenue entry specifically for the National part of the
 * Public Investment Budget (ΠΔΕ).
 * &lt;p&gt;
 * This class implements hierarchical navigation and automated change propagation
 * specifically for national investment resources, while ensuring synchronization
 * with the base public investment filtered data.
 */
public class PublicInvestmentBudgetNationalRevenue extends PublicInvestmentBudgetRevenue implements BudgetRevenueLogic, BudgetRevenueChanges {

    /**
     * Internal registry of all national public investment revenue instances.
     */
<span class="fc" id="L20">    protected static ArrayList&lt;PublicInvestmentBudgetNationalRevenue&gt; publicInvestmentBudgetNationalRevenues = new ArrayList&lt;&gt;();</span>

    /**
     * Constructs a new National PDE revenue entry and creates its corresponding
     * filtered representation in the {@link PublicInvestmentBudgetRevenue} scope.
     *
     * @param code        the unique financial code
     * @param description a brief description of the revenue
     * @param category    the financial category (e.g., &quot;ΕΣΟΔΑ&quot;)
     * @param type        the investment type (e.g., &quot;ΕΘΝΙΚΟ&quot;)
     * @param amount      the initial amount in euros
     */
    public PublicInvestmentBudgetNationalRevenue(String code, String description, String category, String type, long amount) {
<span class="fc" id="L33">        super(code, description, category, type, amount);</span>
<span class="fc" id="L34">        publicInvestmentBudgetNationalRevenues.add(this);</span>

        // Creates a filtered object in the superclass to maintain resource-specific amounts
<span class="fc" id="L37">        new PublicInvestmentBudgetRevenue(code, description, category, type, amount, 0, amount);</span>
<span class="fc" id="L38">    }</span>

    /**
     * Returns the registry of all national public investment revenues.
     * @return an ArrayList of all instances
     */
    public static ArrayList&lt;PublicInvestmentBudgetNationalRevenue&gt; getAllPublicInvestmentBudgetNationalRevenues() {
<span class="fc" id="L45">        return publicInvestmentBudgetNationalRevenues;</span>
    }

    /**
     * Filters and returns only the top-level (2-digit code) national investment revenues.
     * @return an ArrayList of root national entries
     */
    public static ArrayList&lt;PublicInvestmentBudgetNationalRevenue&gt; getMainPublicInvestmentBudgetNationalRevenues() {
<span class="fc" id="L53">        return BudgetRevenueLogicService.getMainBudgetRevenues(publicInvestmentBudgetNationalRevenues);</span>
    }

    /**
     * Searches for a specific national investment revenue by its code.
     * @param code the code to search for
     * @return the matching entry or null if not found
     */
    public static PublicInvestmentBudgetNationalRevenue findPublicInvestmentBudgetNationalRevenueWithCode(String code) {
<span class="fc" id="L62">        return BudgetRevenueLogicService.findRevenueWithCode(code, publicInvestmentBudgetNationalRevenues);</span>
    }

    /**
     * Retrieves all national investment revenues that start with the specified code prefix.
     * @param code the prefix to match
     * @return an ArrayList of matching BudgetRevenue objects
     */
    public static ArrayList&lt;BudgetRevenue&gt; getPublicInvestmentBudgetNationalRevenuesStartingWithCode(String code) {
<span class="fc" id="L71">        return BudgetRevenueLogicService.getRevenuesStartingWithCode(code, publicInvestmentBudgetNationalRevenues);</span>
    }

    /**
     * Calculates the total sum of all main (top-level) national public investment revenues.
     * @return the total amount sum
     */
    public static long calculateSum() {
<span class="fc" id="L79">        return BudgetRevenueLogicService.calculateSum(publicInvestmentBudgetNationalRevenues);</span>
    }

    /* Hierarchy Navigation Implementation */

    /** @return The parent category immediately above this entry in the national hierarchy. */
    @Override
    public PublicInvestmentBudgetNationalRevenue getAboveLevelSuperCategory() {
<span class="fc" id="L87">        return BudgetRevenueLogicService.getAboveLevelSuperCategory(this, publicInvestmentBudgetNationalRevenues);</span>
    }

    /** @return A list of all ancestor categories in the national budget hierarchy. */
    @Override
    public ArrayList&lt;BudgetRevenue&gt; getAllSuperCategories() {
<span class="fc" id="L93">        return BudgetRevenueLogicService.getAllSuperCategories(this, publicInvestmentBudgetNationalRevenues);</span>
    }

    /** @return A list of immediate sub-categories (children) for this entry. */
    @Override
    public ArrayList&lt;BudgetRevenue&gt; getNextLevelSubCategories() {
<span class="fc" id="L99">        return BudgetRevenueLogicService.getNextLevelSubCategories(this, publicInvestmentBudgetNationalRevenues);</span>
    }

    /** @return A list of all descendant categories across all lower hierarchical levels. */
    @Override
    public ArrayList&lt;BudgetRevenue&gt; getAllSubCategories() {
<span class="fc" id="L105">        return BudgetRevenueLogicService.getAllSubCategories(this, publicInvestmentBudgetNationalRevenues);</span>
    }

    /* Change Implementation */

    /**
     * Propagates financial changes to all parent categories in the hierarchy.
     * @param change The amount to adjust for all super categories.
     */
    @Override
    public void setAmountOfSuperCategories(long change) {
<span class="fc" id="L116">        BudgetRevenueChangesService.setAmountOfSuperCategories(this.getAllSuperCategories(), change);</span>
<span class="fc" id="L117">    }</span>

    /**
     * Distributes a fixed amount change equally among all sub-categories.
     * @param change The total amount to distribute equally.
     */
    @Override
    public void setAmountOfAllSubCategoriesWithEqualDistribution(long change) {
<span class="fc" id="L125">        BudgetRevenueChangesService.setAmountOfAllSubCategoriesWithEqualDistribution(this, publicInvestmentBudgetNationalRevenues, change);</span>
<span class="fc" id="L126">    }</span>

    /**
     * Applies a percentage-based adjustment factor to all sub-categories.
     * @param percentage The percentage to apply (e.g., 0.10 for 10%).
     */
    @Override
    public void setAmountOfAllSubCategoriesWithPercentageAdjustment(double percentage) {
<span class="fc" id="L134">        BudgetRevenueChangesService.setAmountOfAllSubCategoriesWithPercentageAdjustment(this, publicInvestmentBudgetNationalRevenues, percentage);</span>
<span class="fc" id="L135">    }</span>

    /**
     * Implements a mass change using equal distribution across the national investment hierarchy.
     * @param change the fixed amount to distribute
     */
    @Override
    public void implementChangesOfEqualDistribution(long change) {
<span class="fc" id="L143">        keepAccountsAndBudgetTypeBeforeChange();</span>
<span class="fc" id="L144">        setAmount(getAmount() + change);</span>
<span class="fc" id="L145">        setAmountOfSuperCategories(change);</span>
<span class="fc" id="L146">        setAmountOfAllSubCategoriesWithEqualDistribution(change);</span>
<span class="fc" id="L147">    }</span>

    /**
     * Implements a mass change using percentage adjustment across the national investment hierarchy.
     * @param percentage the percentage adjustment factor
     */
    @Override
    public void implementChangesOfPercentageAdjustment(double percentage) {
<span class="fc" id="L155">        keepAccountsAndBudgetTypeBeforeChange();</span>
<span class="fc" id="L156">        setAmountOfSuperCategories((long) (getAmount() * (percentage)));</span>
<span class="fc" id="L157">        setAmountOfAllSubCategoriesWithPercentageAdjustment(percentage);</span>
<span class="fc" id="L158">        setAmount((long) (getAmount() * (1 + percentage)));</span>
<span class="fc" id="L159">    }</span>

    /**
     * Records the current state of the hierarchy branch in history before a modification.
     */
    @Override
    public void keepAccountsAndBudgetTypeBeforeChange() {
<span class="fc" id="L166">        ArrayList&lt;BudgetRevenue&gt; accountsForChange = new ArrayList&lt;&gt;(this.getAllSuperCategories());</span>
<span class="fc" id="L167">        accountsForChange.add(this);</span>
<span class="fc" id="L168">        accountsForChange.addAll(getAllSubCategories());</span>
<span class="fc" id="L169">        RevenuesHistory.keepHistory(accountsForChange, BudgetType.PUBLIC_INVESTMENT_BUDGET_NATIONAL);</span>
<span class="fc" id="L170">    }</span>

    /**
     * Updates the national-specific amount field in the filtered superclass object
     * to ensure data consistency.
     * @param change the new national amount
     */
    @Override
    public void updateAmountOfSuperClassFilteredObject(long change) {
<span class="fc" id="L179">        PublicInvestmentBudgetRevenue publicInvestmentBudgetRevenue = PublicInvestmentBudgetRevenue.findPublicInvestmentBudgetRevenueWithCode(this.getCode());</span>
<span class="fc bfc" id="L180" title="All 2 branches covered.">        if (publicInvestmentBudgetRevenue != null ) {</span>
<span class="fc" id="L181">            publicInvestmentBudgetRevenue.setNationalAmount(amount, true);</span>
        }
<span class="fc" id="L183">    }</span>

    /**
     * Sets the amount for this national revenue entry.
     * &lt;p&gt;
     * Performs rounding to the nearest hundred and validates that the amount is non-negative.
     * If validation fails, it triggers a history undo and throws an exception.
     *
     * @param amount the new amount to set
     * @throws IllegalArgumentException if the provided amount is negative
     */
    @Override
    public void setAmount(long amount) {
<span class="fc bfc" id="L196" title="All 2 branches covered.">        if (amount &gt;= 0) {</span>
<span class="fc" id="L197">            amount = BudgetRevenueChangesService.roundToNearestHundred(amount);</span>
<span class="fc" id="L198">            this.amount = amount;</span>
<span class="fc" id="L199">            updateAmountOfSuperClassFilteredObject(amount);</span>
        } else {
<span class="fc" id="L201">            RevenuesHistory.returnToPreviousState();</span>
<span class="fc" id="L202">            throw new IllegalArgumentException();</span>
        }
<span class="fc" id="L204">    }</span>

    /** @return A string representation of the national investment revenue entry. */
    @Override
    public String toString() {
<span class="fc" id="L209">        return super.toString();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>