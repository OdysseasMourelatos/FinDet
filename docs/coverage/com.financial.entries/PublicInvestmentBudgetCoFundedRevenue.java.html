<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PublicInvestmentBudgetCoFundedRevenue.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">FinDet</a> &gt; <a href="index.source.html" class="el_package">com.financial.entries</a> &gt; <span class="el_source">PublicInvestmentBudgetCoFundedRevenue.java</span></div><h1>PublicInvestmentBudgetCoFundedRevenue.java</h1><pre class="source lang-java linenums">package com.financial.entries;

import com.financial.services.*;
import com.financial.services.revenues.*;
import java.util.ArrayList;

/**
 * Represents a revenue entry specifically for the Co-funded (Συγχρηματοδοτούμενο) part
 * of the Public Investment Budget (ΠΔΕ).
 * &lt;p&gt;
 * This class handles co-financed resources, ensuring that any financial changes
 * are correctly propagated through the co-funded hierarchy and synchronized
 * with the base public investment data.
 */
public class PublicInvestmentBudgetCoFundedRevenue extends PublicInvestmentBudgetRevenue implements BudgetRevenueLogic, BudgetRevenueChanges {

    /**
     * Internal registry of all co-funded public investment revenue instances.
     */
<span class="fc" id="L20">    protected static ArrayList&lt;PublicInvestmentBudgetCoFundedRevenue&gt; publicInvestmentBudgetCoFundedRevenues = new ArrayList&lt;&gt;();</span>

    /**
     * Constructs a new Co-funded PDE revenue entry and creates its corresponding
     * filtered representation in the {@link PublicInvestmentBudgetRevenue} scope.
     *
     * @param code        the unique financial code
     * @param description a brief description of the revenue
     * @param category    the financial category (e.g., &quot;ΕΣΟΔΑ&quot;)
     * @param type        the investment type (e.g., &quot;ΣΥΓΧΡΗΜΑΤΟΔΟΤΟΥΜΕΝΟ&quot;)
     * @param amount      the initial amount in euros
     */
    public PublicInvestmentBudgetCoFundedRevenue(String code, String description, String category, String type, long amount) {
<span class="fc" id="L33">        super(code, description, category, type, amount);</span>
<span class="fc" id="L34">        publicInvestmentBudgetCoFundedRevenues.add(this);</span>

        // Creates a filtered object in the superclass, setting the co-funded field
<span class="fc" id="L37">        new PublicInvestmentBudgetRevenue(code, description, category, type, 0, amount, amount);</span>
<span class="fc" id="L38">    }</span>

    /**
     * Returns the registry of all co-funded public investment revenues.
     * @return an ArrayList of all instances
     */
    public static ArrayList&lt;PublicInvestmentBudgetCoFundedRevenue&gt; getAllPublicInvestmentBudgetCoFundedRevenues() {
<span class="fc" id="L45">        return publicInvestmentBudgetCoFundedRevenues;</span>
    }

    /**
     * Filters and returns only the top-level (2-digit code) co-funded revenues.
     * @return an ArrayList of root co-funded entries
     */
    public static ArrayList&lt;PublicInvestmentBudgetCoFundedRevenue&gt; getMainPublicInvestmentBudgetCoFundedRevenues() {
<span class="fc" id="L53">        return BudgetRevenueLogicService.getMainBudgetRevenues(publicInvestmentBudgetCoFundedRevenues);</span>
    }

    /**
     * Searches for a specific co-funded revenue by its code.
     * @param code the code to search for
     * @return the matching entry or null if not found
     */
    public static PublicInvestmentBudgetCoFundedRevenue findPublicInvestmentBudgetCoFundedRevenueWithCode(String code) {
<span class="fc" id="L62">        return BudgetRevenueLogicService.findRevenueWithCode(code, publicInvestmentBudgetCoFundedRevenues);</span>
    }

    /**
     * Retrieves all co-funded revenues that start with the specified code prefix.
     * @param code the prefix to match
     * @return an ArrayList of matching BudgetRevenue objects
     */
    public static ArrayList&lt;BudgetRevenue&gt; getPublicInvestmentBudgetCoFundedRevenuesStartingWithCode(String code) {
<span class="fc" id="L71">        return BudgetRevenueLogicService.getRevenuesStartingWithCode(code, publicInvestmentBudgetCoFundedRevenues);</span>
    }

    /**
     * Calculates the total sum of all main (top-level) co-funded public investment revenues.
     * @return the total amount sum
     */
    public static long calculateSum() {
<span class="fc" id="L79">        return BudgetRevenueLogicService.calculateSum(publicInvestmentBudgetCoFundedRevenues);</span>
    }

    /* Hierarchy Navigation Implementation */

    @Override
    public PublicInvestmentBudgetCoFundedRevenue getAboveLevelSuperCategory() {
<span class="fc" id="L86">        return BudgetRevenueLogicService.getAboveLevelSuperCategory(this, publicInvestmentBudgetCoFundedRevenues);</span>
    }

    @Override
    public ArrayList&lt;BudgetRevenue&gt; getAllSuperCategories() {
<span class="fc" id="L91">        return BudgetRevenueLogicService.getAllSuperCategories(this, publicInvestmentBudgetCoFundedRevenues);</span>
    }

    @Override
    public ArrayList&lt;BudgetRevenue&gt; getNextLevelSubCategories() {
<span class="fc" id="L96">        return BudgetRevenueLogicService.getNextLevelSubCategories(this, publicInvestmentBudgetCoFundedRevenues);</span>
    }

    @Override
    public ArrayList&lt;BudgetRevenue&gt; getAllSubCategories() {
<span class="fc" id="L101">        return BudgetRevenueLogicService.getAllSubCategories(this, publicInvestmentBudgetCoFundedRevenues);</span>
    }

    /* Change Implementation */

    @Override
    public void setAmountOfSuperCategories(long change) {
<span class="fc" id="L108">        BudgetRevenueChangesService.setAmountOfSuperCategories(this.getAllSuperCategories(), change);</span>
<span class="fc" id="L109">    }</span>

    @Override
    public void setAmountOfAllSubCategoriesWithEqualDistribution(long change) {
<span class="fc" id="L113">        BudgetRevenueChangesService.setAmountOfAllSubCategoriesWithEqualDistribution(this, publicInvestmentBudgetCoFundedRevenues, change);</span>
<span class="fc" id="L114">    }</span>

    @Override
    public void setAmountOfAllSubCategoriesWithPercentageAdjustment(double percentage) {
<span class="fc" id="L118">        BudgetRevenueChangesService.setAmountOfAllSubCategoriesWithPercentageAdjustment(this, publicInvestmentBudgetCoFundedRevenues, percentage);</span>
<span class="fc" id="L119">    }</span>

    @Override
    public void implementChangesOfEqualDistribution(long change) {
<span class="fc" id="L123">        keepAccountsAndBudgetTypeBeforeChange();</span>
<span class="fc" id="L124">        setAmount(getAmount() + change);</span>
<span class="fc" id="L125">        setAmountOfSuperCategories(change);</span>
<span class="fc" id="L126">        setAmountOfAllSubCategoriesWithEqualDistribution(change);</span>
<span class="fc" id="L127">    }</span>

    @Override
    public void implementChangesOfPercentageAdjustment(double percentage) {
<span class="fc" id="L131">        keepAccountsAndBudgetTypeBeforeChange();</span>
<span class="fc" id="L132">        setAmountOfSuperCategories((long) (getAmount() * (percentage)));</span>
<span class="fc" id="L133">        setAmountOfAllSubCategoriesWithPercentageAdjustment(percentage);</span>
<span class="fc" id="L134">        setAmount((long) (getAmount() * (1 + percentage)));</span>
<span class="fc" id="L135">    }</span>

    @Override
    public void keepAccountsAndBudgetTypeBeforeChange() {
<span class="fc" id="L139">        ArrayList&lt;BudgetRevenue&gt; accountsForChange = new ArrayList&lt;&gt;(this.getAllSuperCategories());</span>
<span class="fc" id="L140">        accountsForChange.add(this);</span>
<span class="fc" id="L141">        accountsForChange.addAll(getAllSubCategories());</span>
<span class="fc" id="L142">        RevenuesHistory.keepHistory(accountsForChange, BudgetType.PUBLIC_INVESTMENT_BUDGET_COFUNDED);</span>
<span class="fc" id="L143">    }</span>

    /**
     * Updates the co-funded amount field in the filtered {@link PublicInvestmentBudgetRevenue}
     * object to maintain data consistency.
     * @param change the new co-funded amount
     */
    @Override
    public void updateAmountOfSuperClassFilteredObject(long change) {
<span class="fc" id="L152">        PublicInvestmentBudgetRevenue publicInvestmentBudgetRevenue = PublicInvestmentBudgetRevenue.findPublicInvestmentBudgetRevenueWithCode(this.getCode());</span>
<span class="fc bfc" id="L153" title="All 2 branches covered.">        if (publicInvestmentBudgetRevenue != null ) {</span>
<span class="fc" id="L154">            publicInvestmentBudgetRevenue.setCoFundedAmount(amount, true);</span>
        }
<span class="fc" id="L156">    }</span>

    /**
     * Sets the amount for this co-funded revenue entry.
     * &lt;p&gt;
     * Performs financial rounding and validates the value. If negative,
     * the system reverts to the previous state using the history deque.
     *
     * @param amount the new amount to set
     * @throws IllegalArgumentException if the provided amount is negative
     */
    @Override
    public void setAmount(long amount) {
<span class="fc bfc" id="L169" title="All 2 branches covered.">        if (amount &gt;= 0) {</span>
<span class="fc" id="L170">            amount = BudgetRevenueChangesService.roundToNearestHundred(amount);</span>
<span class="fc" id="L171">            this.amount = amount;</span>
<span class="fc" id="L172">            updateAmountOfSuperClassFilteredObject(amount);</span>
        } else {
<span class="fc" id="L174">            RevenuesHistory.returnToPreviousState();</span>
<span class="fc" id="L175">            throw new IllegalArgumentException();</span>
        }
<span class="fc" id="L177">    }</span>

    @Override
    public String toString() {
<span class="fc" id="L181">        return super.toString();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>